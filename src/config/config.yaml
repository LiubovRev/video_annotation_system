# =============================================================================
# Video Annotation System - Central Configuration (Flexible Identity Version)
# =============================================================================

directories:
  raw_video_root:        "data/raw"
  processed_data_dir:    "data/processed"
  annotations_dir:       "data/annotations"
  output_dir:            "outputs"
  models_dir:            "models"

flags:
  skip_video_processing:      false
  skip_pose_extraction:       false
  skip_pose_clustering:       true
  skip_annotation_processing: false
  force_recombine:            false

# -----------------------------------------------------------------------------
# Video Processing
# -----------------------------------------------------------------------------
video_processing:
  raw_video_filename: "camera_a.mkv"
  fps:                15
  step_size:          1
  nb_objects:         3
  yolo_model:         "yolo11m.pt"
  model_size:         "small"
  object_class:       0
  device:             "cuda"

# -----------------------------------------------------------------------------
# Pose Extraction
# -----------------------------------------------------------------------------
pose_extraction:
  directory: "PosesDir"
  abs_base: 0
  fps: 15

  # Neutral labels â€” no assumptions about identity
  id_to_label:
    1: "Person1"
    2: "Person2"
    3: "Person3"

# -----------------------------------------------------------------------------
# Pose Clustering
# -----------------------------------------------------------------------------
pose_clustering:
  movement_threshold:   10
  proximity_close:      200
  proximity_medium:     400
  response_window:      5
  confidence_threshold: 0.5
  smooth_window:        11
  smooth_poly:          3
  k_range:              [2, 8]
  phase_window:         30
  n_phases:             4

  # NEW: flexible role assignment
  role_assignment: "auto"   # "auto" or "manual"

  therapist_labels: ["Therapist1", "Therapist2"]
  child_labels: ["Child"]
  unknown_label: "Unknown"

# -----------------------------------------------------------------------------
# Annotation Alignment
# -----------------------------------------------------------------------------
annotation_alignment:
  features_subdir: "PosesDir"
  columns_to_drop: ["time_min:s.ms"]

  # Supports multiple therapists and unknowns
  label_prefix_map:
    "T1": "Therapist1"
    "T2": "Therapist2"
    "C":  "Child"
    "U":  "Unknown"

  auto_trim_buffer: 5

trim_times: {}
default_trim: [0, null, 15]

label_map:
  0:  "C"
  1:  "CCR"
  2:  "CHO"
  3:  "CSI"
  4:  "CST"
  5:  "T"
  6:  "TC"
  7:  "TRE"
  8:  "TSI"
  9:  "TST"

model:
  file:          "models/model_xgboost.joblib"
  features_file: "models/feature_names.json"
  fps:           15

model_training:
  min_samples_per_class: 30
  test_size:             0.2
  n_iter_search:         50
  non_posture_classes:   ["vocalizations", "unlabeled"]

predict:
  data_path: null

plotting:
  dpi: 300
  figsize_per_project: [18, 10]
  figsize_global: [24, 12]
  colormap: "viridis"
